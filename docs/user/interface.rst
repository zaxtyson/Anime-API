.. _interface:

===============
è·¯ç”±æ¥å£è¯´æ˜
===============

- API çš„è·¯ç”±è¿”å›çš„æ•°æ®ä¸º JSON æ ¼å¼
- ä½¿ç”¨ GET æˆ–è€… Websocket è·å–æ•°æ®
- ä½¿ç”¨ POST åŠ¨æ€ä¿®æ”¹å¼•æ“å¯ç”¨çŠ¶æ€

è§†é¢‘ç›¸å…³æ¥å£
===================

GET /anime/search/<keyword>
""""""""""""""""""""""""""""""""""""
è§†é¢‘æœç´¢æ¥å£, è¯¥æ¥å£é˜»å¡è‡³æ‰€æœ‰å¼•æ“å¤„ç†å®Œæˆ, è¿”å›å…¨éƒ¨æœç´¢ç»“æœ

==========  ==========  ==========
å‚æ•°          ç±»å‹           å¤‡æ³¨
==========  ==========  ==========
keyword        str          å…³é”®è¯
==========  ==========  ==========

è¿”å›å€¼:

.. code-block:: json

    [
        {
            "category": "çƒ­è¡€,å¥‡å¹»",
            "cover_url": "https://img9.doubanio.com/view/photo/m/public/p2578234476.jpg",
            "description": "",
            "module": "api.anime.bimibimi",
            "score": 80,
            "title": "å‡¡äººä¿®ä»™ä¼ ",
            "url": "http://localhost:6001/anime/62696d6962696d697c313730"
        },
        {
            "category": "åŠ¨æ¼«",
            "cover_url": "https://ae01.alicdn.com/kf/Udadf545b192247c9988db45344177cd7e.jpg",
            "description": "å¹³å‡¡å°‘å¹´éŸ©ç«‹å‡ºç”Ÿè´«å›°ï¼Œä¸ºäº†è®©å®¶äººè¿‡ä¸Šæ›´å¥½çš„ç”Ÿæ´»ï¼Œè‡ªæ„¿å‰å»ä¸ƒç„é—¨å‚åŠ å…¥é—¨è€ƒæ ¸ï¼Œæœ€ç»ˆè¢«å¢¨å¤§å¤«æ”¶å…¥é—¨ä¸‹å¢¨å¤§...",
            "module": "api.anime.k1080",
            "score": 80,
            "title": "å‡¡äººä¿®ä»™ä¼ ",
            "url": "http://localhost:6001/anime/6b313038307c2f766f6464657461696c2f3338373736332e68746d6c"
        },
        {
            "category": "å¥‡å¹» ç„å¹»",
            "cover_url": "http://sc02.alicdn.com/kf/H72ad113e1a8d43758724d7c1eda50557n.jpg",
            "description": "å‡¡äººå‡ºèº«çš„é’å¹´éŸ©ç«‹ä¸ºæ±‚å¤§é“ï¼Œçºµæ¨ªäººã€çµã€ä»™ä¸‰ç•Œï¼ŒæŒæ¡åŠ›é‡ï¼Œæƒ©æ¶æ‰¬å–„ï¼Œå¿«æ„æ©ä»‡çš„æ—…ç¨‹ã€‚æç»˜äº†ä¸€ä¸ªå®å¤§ä¸¥è°¨çš„ä»™ä¾ ä¸–ç•Œï¼Œä»¥å……æ»¡æƒ³è±¡åŠ›çš„æƒ…èŠ‚ï¼Œä»£å…¥æ„Ÿæå¼ºçš„äººç‰©ï¼Œè·Œå®•èµ·ä¼çš„æ•…äº‹ï¼Œæˆä¸ºå½“ä»£ä¸­å›½ä»™ä¾ æ–‡å­¦å½“ä»ä¸è®©çš„å›½æ°‘çº§IPã€‚",
            "module": "api.anime.agefans",
            "score": 80,
            "title": "å‡¡äººä¿®ä»™ä¼ ",
            "url": "http://localhost:6001/anime/61676566616e737c3230323030323833"
        }
    ]

- `score` å­—æ®µæ˜¯å¯¹äºèµ„æºè´¨é‡çš„è¯„åˆ†ï¼Œç›®å‰æš‚æœªå®ç°ã€‚
- `module` å­—æ®µè¡¨æ˜äº†èµ„æºçš„æ¥æºå¼•æ“ï¼Œåç»­ä¼šè°ƒåº¦è¯¥å¼•æ“å®Œæˆä¸‹ä¸€æ­¥çš„è§£æå·¥ä½œã€‚
- `url` å­—æ®µçš„é“¾æ¥æŒ‡å‘èµ„æºçš„æ’­æ”¾åˆ—è¡¨ä¿¡æ¯ï¼Œè®¿é—®æ—¶æ‰ä¼šè§£æï¼Œè§£æç»“æœä¼šè¢«ç¼“å­˜ã€‚

WS  /anime/search
"""""""""""""""""""""""""""""""""""""
å¼‚æ­¥è§†é¢‘æœç´¢æ¥å£, é€šè¿‡ Websocket å³æ—¶æ¨é€æœç´¢ç»“æœ

Web ç«¯:

.. code-block:: javascript

    function search(keyword) {
        let ws = new WebSocket("ws://localhost:6001/anime/search");

        ws.onopen = function (evt) {
            console.log("Connection open ...");
            ws.send(keyword);
        };

        ws.onmessage = function (evt) {
            let data = JSON.parse(evt.data);
            console.log(`Received Message: ${JSON.stringify(data)}`);
        };

        ws.onclose = function (evt) {
            console.log("Connection closed.");
        };
    }


.. code-block:: javascript

    search("å‡¡äººä¿®ä»™ä¼ ")

å½“æŸä¸€ä¸ªå¼•æ“æœç´¢åˆ°æ•°æ®ï¼Œå°†ç«‹å³æ¨é€ç»™å‰ç«¯:

.. code-block::

    Connection open ...
    Received Message: {"category":"çƒ­è¡€,å¥‡å¹»","cover_url":"https://img9.doubanio.com/view/photo/m/public/p2578234476.jpg","description":"","engine":"api.anime.bimibimi","score":80,"title":"å‡¡äººä¿®ä»™ä¼ ","url":"http://localhost:6001/anime/62696d6962696d697c313730"}
    Received Message: {"category":"åŠ¨æ¼«","cover_url":"https://ae01.alicdn.com/kf/Udadf545b192247c9988db45344177cd7e.jpg","description":"å¹³å‡¡å°‘å¹´éŸ©ç«‹å‡ºç”Ÿè´«å›°ï¼Œä¸ºäº†è®©å®¶äººè¿‡ä¸Šæ›´å¥½çš„ç”Ÿæ´»ï¼Œè‡ªæ„¿å‰å»ä¸ƒç„é—¨å‚åŠ å…¥é—¨è€ƒæ ¸ï¼Œæœ€ç»ˆè¢«å¢¨å¤§å¤«æ”¶å…¥é—¨ä¸‹å¢¨å¤§...","engine":"api.anime.k1080","score":80,"title":"å‡¡äººä¿®ä»™ä¼ ","url":"http://localhost:6001/anime/6b313038307c2f766f6464657461696c2f3338373736332e68746d6c"}
    Received Message: {"category":"å¥‡å¹» ç„å¹»","cover_url":"http://sc02.alicdn.com/kf/H72ad113e1a8d43758724d7c1eda50557n.jpg","description":"å‡¡äººå‡ºèº«çš„é’å¹´éŸ©ç«‹ä¸ºæ±‚å¤§é“ï¼Œçºµæ¨ªäººã€çµã€ä»™ä¸‰ç•Œï¼ŒæŒæ¡åŠ›é‡ï¼Œæƒ©æ¶æ‰¬å–„ï¼Œå¿«æ„æ©ä»‡çš„æ—…ç¨‹ã€‚æç»˜äº†ä¸€ä¸ªå®å¤§ä¸¥è°¨çš„ä»™ä¾ ä¸–ç•Œï¼Œä»¥å……æ»¡æƒ³è±¡åŠ›çš„æƒ…èŠ‚ï¼Œä»£å…¥æ„Ÿæå¼ºçš„äººç‰©ï¼Œè·Œå®•èµ·ä¼çš„æ•…äº‹ï¼Œæˆä¸ºå½“ä»£ä¸­å›½ä»™ä¾ æ–‡å­¦å½“ä»ä¸è®©çš„å›½æ°‘çº§IPã€‚","engine":"api.anime.agefans","score":80,"title":"å‡¡äººä¿®ä»™ä¼ ","url":"http://localhost:6001/anime/61676566616e737c3230323030323833"}
    Connection closed.


GET /anime/<token>
""""""""""""""""""""""""""""""""
å‰§é›†è¯¦æƒ…æ¥å£, è¿”å›æ’­æ”¾åˆ—è¡¨ç­‰ä¿¡æ¯

==========  ==========  ==========
å‚æ•°          ç±»å‹           å¤‡æ³¨
==========  ==========  ==========
token        str        æ’­æ”¾åˆ—è¡¨çš„å”¯ä¸€æ ‡è¯†
==========  ==========  ==========

è¿”å›å€¼(ç»“æœè¿‡å¤šå·²çœç•¥):

.. code-block:: json

    {
        "title": "å‡¡äººä¿®ä»™ä¼ ",
        "category": "åŠ¨æ¼«",
        "cover_url": "https://ae01.alicdn.com/kf/Uba0447ef35b64eb59a3b4793cae384c6i.jpg",
        "description": "å¹³å‡¡å°‘å¹´éŸ©ç«‹å‡ºç”Ÿè´«å›°ï¼Œä¸ºäº†è®©å®¶äººè¿‡ä¸Šæ›´å¥½çš„ç”Ÿæ´»ï¼Œè‡ªæ„¿å‰å»ä¸ƒç„é—¨å‚åŠ å…¥é—¨è€ƒæ ¸ï¼Œæœ€ç»ˆ...",
        "module": "api.anime.k1080",
        "play_lists": [
            {
                "name": "è¶…æ¸…æ¨è",
                "num": 20,
                "video_list": [
                    {
                        "info": "http://localhost:6001/anime/6b313038307c2f766f6464657461696c2f3338373736332e68746d6c/0/0",
                        "name": "01",
                        "player": "http://localhost:6001/anime/6b313038307c2f766f6464657461696c2f3338373736332e68746d6c/0/0/player"
                    },
                    {
                        "info": "http://localhost:6001/anime/6b313038307c2f766f6464657461696c2f3338373736332e68746d6c/0/1",
                        "name": "02",
                        "player": "http://localhost:6001/anime/6b313038307c2f766f6464657461696c2f3338373736332e68746d6c/0/1/player"
                    },
                    {
                        "info": "http://localhost:6001/anime/6b313038307c2f766f6464657461696c2f3338373736332e68746d6c/0/2",
                        "name": "03",
                        "player": "http://localhost:6001/anime/6b313038307c2f766f6464657461696c2f3338373736332e68746d6c/0/2/player"
                    }
                ]
            },
            {
                "name": "ok",
                "num": 20,
                "video_list": [
                    {
                        "info": "http://localhost:6001/anime/6b313038307c2f766f6464657461696c2f3338373736332e68746d6c/1/0",
                        "name": "ç¬¬01é›†",
                        "player": "http://localhost:6001/anime/6b313038307c2f766f6464657461696c2f3338373736332e68746d6c/1/0/player"
                    },
                    {
                        "info": "http://localhost:6001/anime/6b313038307c2f766f6464657461696c2f3338373736332e68746d6c/1/1",
                        "name": "ç¬¬02é›†",
                        "player": "http://localhost:6001/anime/6b313038307c2f766f6464657461696c2f3338373736332e68746d6c/1/1/player"
                    }
                ]
            }
        ]
    }

- `play_lists` ä¸­å¯èƒ½åŒ…å«å¤šä¸ªæ’­æ”¾åˆ—è¡¨(è·¯çº¿)ã€‚
- `player` å­—æ®µæ˜¯æ’­æ”¾å™¨åœ°å€(æ— å¼¹å¹•)ï¼Œç”¨äºæµ‹è¯•è§†é¢‘ç›´é“¾æˆ–è€…ä»£ç†åŠŸèƒ½æ˜¯å¦æ­£å¸¸ã€‚
- `info` å­—æ®µçš„é“¾æ¥æŒ‡å‘è§†é¢‘çš„è¯¦ç»†è¯¦ç»†ï¼Œè®¿é—®æ—¶æ‰è§£æï¼Œè§£æç»“æœä¼šè¢«ç¼“å­˜ã€‚

GET /anime/<token>/<playlist>/<episode>
"""""""""""""""""""""""""""""""""""""""""""""""""
è·å–æŸä¸€é›†è§†é¢‘çš„è¯¦ç»†ä¿¡æ¯

==========  ==========  ==========
å‚æ•°          ç±»å‹           å¤‡æ³¨
==========  ==========  ==========
token        str        èµ„æºtoken
playlist     int        æ’­æ”¾åˆ—è¡¨ç¼–å·
episode      int        è§†é¢‘é›†æ•°ç¼–å·
==========  ==========  ==========

è¿”å›å€¼:

.. code-block:: json

    {
        "format": "mp4",
        "lifetime": 86399,
        "proxy_url": "http://localhost:6001/proxy/stream/6b313038307c2f766f6464657461696c2f3338373736332e68746d6c/0/0",
        "raw_url": "http://localhost:6001/anime/6b313038307c2f766f6464657461696c2f3338373736332e68746d6c/0/0/url",
        "resolution": "1280x720",
        "size": 919586946
    }

- `format` å­—æ®µæ˜¯æ ¹æ® URL å’Œ Content-Type æ¨æ–­å‡ºæ¥çš„è§†é¢‘æ ¼å¼
  (æœªå¯ç”¨ `Magic Number <https://en.wikipedia.org/wiki/Magic_number_(programming)>`_ æ¨å¯¼è§†é¢‘æ ¼å¼)ã€‚
- `lifetime` å­—æ®µæ˜¯ç”¨æˆ·è§£æç›´é“¾æ—¶è®¾ç½®çš„ç›´é“¾æœ‰æ•ˆæœŸï¼Œå•ä½ä¸ºç§’ã€‚è‹¥ç”¨æˆ·æ²¡æœ‰è®¾ç½®ç›´é“¾æœ‰æ•ˆæœŸï¼Œ API å°†ä» URL ä¸­å¯»æ‰¾ä¸€ä¸ªæœ‰æ•ˆçš„æ—¶é—´æˆ³
  æ¥æ¨æ–­ç›´é“¾ç”Ÿå‘½å‘¨æœŸï¼Œå¦‚æœæ¨æ–­å¤±è´¥ï¼Œåˆ™é»˜è®¤ç›´é“¾æœ‰æ•ˆæœŸä¸ºä¸€å¤©ã€‚
- `raw_url` å­—æ®µæ˜¯è§†é¢‘çš„ç›´é“¾ï¼Œè¿™é‡Œç»™å‡ºçš„å€¼æ˜¯ API çš„ä¸€ä¸ªè·¯ç”±åœ°å€ï¼Œå®ƒä¼šåŠ¨æ€åœ°é‡å®šå‘åˆ°è§†é¢‘çš„ç›´é“¾(å½“ç¼“å­˜çš„ç›´é“¾è¿‡æœŸæ—¶ï¼Œé‡æ–°è§£æå¹¶é‡å®šå‘)
- `proxy_url` å­—æ®µæ˜¯ä»£ç† URL åœ°å€ï¼Œå¯ä½œä¸ºè§†é¢‘ç›´é“¾ä½¿ç”¨ã€‚å½“è§†é¢‘å­˜åœ¨é˜²ç›—é“¾æ—¶ï¼ŒAPI ä½œä¸ºä»£ç†æœåŠ¡å™¨è½¬å‘è§†é¢‘æ•°æ®æµã€‚å¦‚æœè§†é¢‘ä¸º `HLS` ( `m3u8` )
  æ ¼å¼ï¼Œè¯¥æ¥å£å°†é‡å®šå‘åˆ°åŸå§‹ç›´é“¾(é€šå¸¸æä¾› `HLS` è§†é¢‘çš„æœåŠ¡å™¨æ”¯æŒ CORSï¼Œè€Œå¯¹äº `HLS` æµåª’ä½“çš„ä»£ç†ååˆ†å¤æ‚ï¼Œæš‚æœªå®ç°)
- `resolution` å­—æ®µæ˜¯ä» `MPEG-TS <https://en.wikipedia.org/wiki/MPEG_transport_stream>`_ /
  `MPEG-4 <https://en.wikipedia.org/wiki/MPEG-4>`_ æµçš„å…ƒæ•°æ®ä¸­æ¨æ–­å‡ºæ¥çš„è§†é¢‘åˆ†è¾¨ç‡ï¼Œç›®å‰æš‚æœªå®Œæ•´å®ç°ã€‚
- `size` å­—æ®µä¸ºè§†é¢‘çš„å­—èŠ‚å¤§å°ï¼Œå¯¹äº `m3u8` è§†é¢‘çš„å¤§å°æ¨æ–­æš‚ä¸å‡†ç¡®ã€‚

GET /anime/bangumi/updates
""""""""""""""""""""""""""""""""""""""""""""""""""""""
ç•ªç»„è¡¨æ¥å£, è·å–æœ€è¿‘ä¸€æ®µæ—¶é—´æ›´æ–°çš„ç•ªå‰§ä¿¡æ¯

è¿”å›å€¼(ç»“æœè¿‡å¤šå·²çœç•¥):

.. code-block:: json

    [
        {
            "date": "2021-02-16",
            "day_of_week": "2",
            "is_today": false,
            "updates": [
                {
                    "cover_url": "http://i0.hdslb.com/bfs/bangumi/image/8d1be9e8c77696f34886b8f471d935f504a014d3.jpg",
                    "title": "å¤©å®˜èµç¦",
                    "update_time": "2021-02-16 11:00:00",
                    "update_to": "ç‰¹åˆ«ç¯‡"
                }
            ]
        },
        {
            "date": "2021-02-17",
            "day_of_week": "3",
            "is_today": false,
            "updates": [
                {
                    "cover_url": "http://i0.hdslb.com/bfs/bangumi/image/a4ca27f00b7ad3f319e04723ee29a3a1a435e666.jpg",
                    "title": "é˜¿è¡° ç¬¬å››å­£",
                    "update_time": "2021-02-17 20:00:00",
                    "update_to": "ç¬¬1è¯-ç¬¬3è¯"
                }
            ]
        }
    ]

- ç•ªç»„è¡¨å¤§æ¦‚æœ‰ä¸€ä¸ªæœˆçš„æ•°æ®
- `day_of_week` å­—æ®µè¡¨ç¤ºå½“å‰æ˜ŸæœŸå‡ 
- `is_today` å­—æ®µè¡¨ç¤ºæ˜¯å¦æ˜¯ä»Šå¤©çš„æ•°æ®
- `update_time` å­—æ®µä¸ºç•ªå‰§çš„æ›´æ–°æ—¶é—´
- `update_to` å­—æ®µä¸ºæœ€æ–°ä¸€è¯çš„å†…å®¹

-------------------------------------------------

å¼¹å¹•ç›¸å…³æ¥å£
=====================

GET /danmaku/search/<keyword>
""""""""""""""""""""""""""""""""""""""""""""""
å¼¹å¹•æœç´¢æ¥å£, é˜»å¡è‡³æ‰€æœ‰å¼•æ“å¤„ç†å®Œæˆ, è¿”å›å…¨éƒ¨ç»“æœ

==========  ==========  ==========
å‚æ•°          ç±»å‹           å¤‡æ³¨
==========  ==========  ==========
keyword        str          å…³é”®è¯
==========  ==========  ==========

è¿”å›å€¼:

.. code-block:: json

    [
        {
            "module": "api.danmaku.bilibili",
            "num": 6,
            "score": 80,
            "title": "Reï¼šä»é›¶å¼€å§‹çš„å¼‚ä¸–ç•Œç”Ÿæ´» ç¬¬äºŒå­£ ååŠ",
            "url": "http://localhost:6001/danmaku/62696c6962696c697c2f62616e67756d692f706c61792f737333363432392f"
        },
        {
            "module": "api.danmaku.bilibili",
            "num": 13,
            "score": 80,
            "title": "Reï¼šä»é›¶å¼€å§‹çš„å¼‚ä¸–ç•Œç”Ÿæ´» ç¬¬äºŒå­£ å‰åŠ",
            "url": "http://localhost:6001/danmaku/62696c6962696c697c2f62616e67756d692f706c61792f737333333830322f"
        },
        {
            "module": "api.danmaku.tencent",
            "num": 19,
            "score": 80,
            "title": "Re:ä»é›¶å¼€å§‹çš„å¼‚ä¸–ç•Œç”Ÿæ´» ç¬¬2å­£",
            "url": "http://localhost:6001/danmaku/74656e63656e747c6d7a63303032303063386b306c7a31"
        }
    ]

- æœç´¢ä¸€æ¬¡è§†é¢‘ï¼Œåœ¨ä¸åŒçš„æœç´¢ç»“æœé—´åˆ‡æ¢æ—¶æœç´¢å¼¹å¹•åº“ä½¿ç”¨çš„å…³é”®è¯å¾€å¾€ç›¸åŒï¼Œæ‰€ä»¥å¼¹å¹•æœç´¢ç»“æœä¼šè¢«ç¼“å­˜ã€‚
- `num` å­—æ®µè¡¨ç¤ºå¼¹å¹•æ’­æ”¾åˆ—è¡¨çš„é›†æ•°ï¼Œ`-1` è¡¨ç¤ºè§£æå‰æ— æ³•è·å–æ•°é‡ä¿¡æ¯ã€‚
- `score` å­—æ®µæ˜¯å¯¹äºèµ„æºçš„è´¨é‡çš„è¯„åˆ†ï¼Œç›®å‰æš‚æœªå®ç°ã€‚
- `url` å­—æ®µæŒ‡å‘è¯¥å¼¹å¹•æ’­æ”¾åˆ—è¡¨çš„è¯¦ç»†ä¿¡æ¯ï¼Œè®¿é—®æ—¶è§£æï¼Œè§£æç»“æœä¼šè¢«ç¼“å­˜ã€‚

WS  /danmaku/search
"""""""""""""""""""""""""""""""""
å¼‚æ­¥å¼¹å¹•æœç´¢æ¥å£, é€šè¿‡ Websocket å³æ—¶æ¨é€æœç´¢ç»“æœ

Web ç«¯:

.. code-block:: javascript

    function search(keyword) {
        let ws = new WebSocket("ws://localhost:6001/danmaku/search");

        ws.onopen = function (evt) {
            console.log("Connection open ...");
            ws.send(keyword);
        };

        ws.onmessage = function (evt) {
            let data = JSON.parse(evt.data);
            console.log(`Received Message: ${JSON.stringify(data)}`);
        };

        ws.onclose = function (evt) {
            console.log("Connection closed.");
        };
    }


.. code-block:: javascript

    search("è¿›å‡»çš„å·¨äºº")

å½“æŸä¸€ä¸ªå¼•æ“æœç´¢åˆ°æ•°æ®ï¼Œå°†ç«‹å³æ¨é€ç»™å‰ç«¯:

.. code-block::

    Connection open ...
    Received Message: {"module":"api.danmaku.bahamut","num":9,"score":80,"title":"è¿›å‡»çš„å·¨äºº The Final Season","url":"http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232"}
    Received Message: {"module":"api.danmaku.bahamut","num":25,"score":80,"title":"è¿›å‡»çš„å·¨äºº","url":"http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d3539323231"}
    Received Message: {"module":"api.danmaku.bahamut","num":23,"score":80,"title":"è¿›å‡»çš„å·¨äºº ç¬¬ä¸‰å­£","url":"http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d3839353537"}
    Received Message: {"module":"api.danmaku.bahamut","num":17,"score":80,"title":"è¿›å‡»çš„å·¨äºº ç¬¬äºŒå­£","url":"http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d3732373535"}
    Received Message: {"module":"api.danmaku.bahamut","num":1,"score":80,"title":"è¿›å‡»çš„å·¨äºº å‰§åœºç‰ˆ CHRONICLE","url":"http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313131363532"}
    Received Message: {"module":"api.danmaku.bahamut","num":1,"score":80,"title":"å‰§åœºç‰ˆ è¿›å‡»çš„å·¨äºº è§‰é†’çš„å’†å“®","url":"http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d3932323735"}
    Received Message: {"module":"api.danmaku.bahamut","num":1,"score":80,"title":"å‰§åœºç‰ˆ è¿›å‡»çš„å·¨äºº å‰ç¼– çº¢è²çš„å¼“çŸ¢","url":"http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d3638373531"}
    Received Message: {"module":"api.danmaku.bahamut","num":1,"score":80,"title":"å‰§åœºç‰ˆ è¿›å‡»çš„å·¨äºº åç¼– è‡ªç”±ä¹‹ç¿¼","url":"http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d3638373532"}
    Received Message: {"module":"api.danmaku.bilibili","num":12,"score":80,"title":"é€²æ“Šçš„å·¨äºº ç¬¬äºŒå­£ï¼ˆåƒ…é™å°ç£åœ°å€ï¼‰","url":"http://localhost:6001/danmaku/62696c6962696c697c2f62616e67756d692f706c61792f7373353937302f"}
    Received Message: {"module":"api.danmaku.bilibili","num":10,"score":80,"title":"é€²æ“Šçš„å·¨äºº ç¬¬ä¸‰å­£ Part.2ï¼ˆåƒ…é™å°ç£åœ°å€ï¼‰","url":"http://localhost:6001/danmaku/62696c6962696c697c2f62616e67756d692f706c61792f737332363936332f"}
    Received Message: {"module":"api.danmaku.bilibili","num":12,"score":80,"title":"é€²æ“Šçš„å·¨äºº ç¬¬ä¸‰å­£ï¼ˆåƒ…é™å°ç£åœ°å€ï¼‰","url":"http://localhost:6001/danmaku/62696c6962696c697c2f62616e67756d692f706c61792f737332343632392f"}
    Connection closed.


GET /danmaku/<token>
""""""""""""""""""""""""""""""""""""
å¼¹å¹•è¯¦æƒ…æ¥å£, è¿”å›å¼¹å¹•æ’­æ”¾åˆ—è¡¨

==========  ==========  ==========
å‚æ•°          ç±»å‹           å¤‡æ³¨
==========  ==========  ==========
token        str         è¯¥å¼¹å¹•åˆ—è¡¨çš„å”¯ä¸€æ ‡è¯†
==========  ==========  ==========

è¿”å›å€¼:

.. code-block:: json

    [
        {
            "data": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/0/v3/",
            "name": "1",
            "url": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/0"
        },
        {
            "data": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/1/v3/",
            "name": "2",
            "url": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/1"
        },
        {
            "data": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/2/v3/",
            "name": "3",
            "url": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/2"
        },
        {
            "data": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/3/v3/",
            "name": "4",
            "url": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/3"
        },
        {
            "data": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/4/v3/",
            "name": "5",
            "url": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/4"
        },
        {
            "data": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/5/v3/",
            "name": "6",
            "url": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/5"
        },
        {
            "data": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/6/v3/",
            "name": "7",
            "url": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/6"
        },
        {
            "data": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/7/v3/",
            "name": "8",
            "url": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/7"
        },
        {
            "data": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/8/v3/",
            "name": "9",
            "url": "http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/8"
        }
    ]

- `url` å­—æ®µå¡«å…¥ `Dplayer` ä½œä¸ºå¼¹å¹•åœ°å€
- `data` å­—æ®µç”¨äºæµ‹è¯•, è¿”å›å¼¹å¹•æ± æ•°æ®(`DPlayer` ä¼šè‡ªåŠ¨åœ¨ `url` åé¢åŠ ä¸Š `/v3/` )

Dplayer `é…ç½® <https://dplayer.js.org/zh/guide.html#%E5%BC%B9%E5%B9%95%E6%8E%A5%E5%8F%A3>`_:

.. code-block:: javascript

    const option = {
        danmaku: {
            addition: ['http://localhost:6001/danmaku/626168616d75747c616e696d655265662e7068703f736e3d313132353232/8']
        }
    };

GET /danmaku/<token>/<episode>/v3/
""""""""""""""""""""""""""""""""""""""""
å¼¹å¹•æ•°æ®æ¥å£, è¿”å›ä¸€é›†è§†é¢‘çš„å¼¹å¹•( `Dplayer` æ ¼å¼)

==========  ==========  ==========
å‚æ•°          ç±»å‹           å¤‡æ³¨
==========  ==========  ==========
token        str         å¼¹å¹•æ’­æ”¾åˆ—è¡¨å”¯ä¸€æ ‡è¯†
episode      int         å¼¹å¹•é›†æ•°ç¼–å·
==========  ==========  ==========

è¿”å›å€¼(ç»“æœè¿‡å¤šå·²çœç•¥):

.. code-block:: json

    {
        "code": 0,
        "num": 2785,
        "data": [
            [0, 0, 16777215, "", "å¤©å•Š è¿Ÿåˆ°äº†"],
            [0, 0, 16777215, "", "ã„¢ã„¢"],
            [0, 0, 16777215, "", "äºŒåˆ·"],
            [0, 2, 16711718, "", "ç»ˆäº"],
            [0, 0, 16777215, "", "0"],
            [0, 0, 16777215, "", "ä¸»å¸­å¥½"],
            [0, 0, 16639293, "", "ç»ˆäºæ¥çœ‹ç¬¬å››å­£äº†å•¦"],
            [0, 0, 16750117, "", "è¿›å‡»çš„è§‚ä¼—ï¼"],
            [0, 1, 16711718, "", "ä»¥ä¸‰åˆ·"],
            [0, 1, 16711718, "", "ä»¥2åˆ·"],
            [0, 0, 16777215, "", "ğŸ˜"],
            [0, 0, 16777215, "", "èµå–”ï¼"]
        ]
    }

- `num` å­—æ®µè¡¨å¼¹å¹•æ¡æ•°
- å¼¹å¹•æ ¼å¼ä¸º: `[time, pos, color, user, message]` ,
  `time` è·ç¦»è§†é¢‘å¼€å¤´çš„ç§’æ•°(float),
  `pos` ä½ç½®å‚æ•°(0å³è¾¹, 1ä¸Šè¾¹, 2åº•éƒ¨),
  `color` é¢œè‰²ç  10 è¿›åˆ¶,
  `user` å‘é€å¼¹å¹•çš„ç”¨æˆ·å,
  `message` ä¸ºå¼¹å¹•æ­£æ–‡å†…å®¹,

---------------------------------------------

æ¼«ç”»ç›¸å…³æ¥å£
===================
æš‚æ— ï¼Œæ•¬è¯·æœŸå¾…~

---------------------------------------------

å°è¯´ç›¸å…³æ¥å£
=====================
æš‚æ— ï¼Œæ•¬è¯·æœŸå¾…~

---------------------------------------------

éŸ³ä¹ç›¸å…³æ¥å£
========================
æš‚æ— ï¼Œæ•¬è¯·æœŸå¾…~

---------------------------------------------

IPTVç›¸å…³æ¥å£
==============

GET /iptv/list
"""""""""""""""""""""""""
è·å– IPTV æºåˆ—è¡¨

è¿”å›å€¼(ç»“æœè¿‡å¤šå·²çœç•¥):

.. code-block:: json

    [
        {
            "name": "CCTV-10ç§‘æ•™",
            "url": "http://ivi.bupt.edu.cn/hls/cctv10.m3u8"
        },
        {
            "name": "CCTV-11æˆæ›²",
            "url": "http://ivi.bupt.edu.cn/hls/cctv11.m3u8"
        },
        {
            "name": "CCTV-12ç¤¾ä¼šä¸æ³•",
            "url": "http://ivi.bupt.edu.cn/hls/cctv12.m3u8"
        },
        {
            "name": "CCTV-13æ–°é—»",
            "url": "http://ivi.bupt.edu.cn/hls/cctv13.m3u8"
        },
        {
            "name": "CCTV-14å°‘å„¿",
            "url": "http://ivi.bupt.edu.cn/hls/cctv14.m3u8"
        }
    ]

- ç›®å‰åªæœ‰å›½å†…åœ°æ–¹å«è§†å°å’Œ CCTV
- æ›´å¤šæ¥æºç­‰å¾…æ·»åŠ 

---------------------------------------------

ä»£ç†ç›¸å…³æ¥å£
===============

GET /proxy/image/<url>
""""""""""""""""""""""""""""""""
ä»£ç†è®¿é—®è·¨åŸŸçš„å›¾ç‰‡èµ„æº

==========  ==========  ==========
å‚æ•°          ç±»å‹           å¤‡æ³¨
==========  ==========  ==========
url           str         ç›®æ ‡ URL
==========  ==========  ==========

å¦‚æœç›´æ¥è®¿é—®å›¾ç‰‡å‡ºç°è·¨åŸŸé—®é¢˜, å¯é€šè¿‡æ­¤æ¥å£ä»£ç†è®¿é—®, æ¥å£åŸæ ·è½¬å‘æœåŠ¡å™¨çš„å“åº”ã€‚

GET /proxy/stream/<token>/<playlist>/<episode>
""""""""""""""""""""""""""""""""""""""""""""""""""""""""
ä»£ç†æ™®é€šè§†é¢‘æ•°æ®æµ, ç”¨äºè§£å†³é˜²ç›—é“¾å’Œè·¨åŸŸé—®é¢˜

==========  ==========  ==========
å‚æ•°          ç±»å‹           å¤‡æ³¨
==========  ==========  ==========
token        str        èµ„æºtoken
playlist     int        æ’­æ”¾åˆ—è¡¨ç¼–å·
episode      int        è§†é¢‘é›†æ•°ç¼–å·
==========  ==========  ==========

ä½¿ç”¨ç”¨æˆ·å®šä¹‰çš„ `Headers` è®¿é—®åŸå§‹èµ„æº, æ ¹æ®è¯·æ±‚ä¸­ `Range` å­—æ®µè¿”å›æŒ‡å®šä½ç½®çš„è§†é¢‘æ•°æ®æµã€‚
å¦‚æœå¤„ç†è¿‡ç¨‹ä¸­ç›´é“¾å¤±æ•ˆï¼Œä¼šè‡ªåŠ¨é‡æ–°è§£æã€‚

GET /proxy/hls/<token>/<playlist>/<episode>
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""
ä»£ç† HLS è§†é¢‘æ•°æ®æµ, ç”¨äºè§£å†³é˜²ç›—é“¾å’Œè·¨åŸŸé—®é¢˜

==========  ==========  ==========
å‚æ•°          ç±»å‹           å¤‡æ³¨
==========  ==========  ==========
token        str        èµ„æºtoken
playlist     int        æ’­æ”¾åˆ—è¡¨ç¼–å·
episode      int        è§†é¢‘é›†æ•°ç¼–å·
==========  ==========  ==========

è¯¥åŠŸèƒ½æš‚æœªå®ç°ï¼š

- æä¾› `HLS` è§†é¢‘çš„æœåŠ¡å™¨é€šå¸¸æ”¯æŒ CORS
- `HLS` ä»£ç†æ¯”è¾ƒå¤æ‚ï¼Œè®¸å¤šç«™è¿”å›çš„æ•°æ®æ ¼å¼ä¸è§„èŒƒï¼Œæˆ–å­˜åœ¨è‡ªå®šä¹‰çš„åŠ å¯†æ‰‹æ®µã€‚

---------------------------------------------

ç³»ç»Ÿç›¸å…³æ¥å£
================

GET /system/logs
""""""""""""""""""""""""""""""
è·å– API çš„è¿è¡Œæ—¥å¿—

GET /system/version
""""""""""""""""""""""""""""""""
è·å–ç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯

è¿”å›å€¼:

.. code-block:: json

    {
      "desc": "æ­ªæ¯”æ­ªæ¯”ï¼Œæ­ªæ¯”å·´åœ",
      "tag": "1.3.0",
      "time": "2021-02-10",
      "update": "https://gitee.com/api/v5/repos/zaxtyson/AnimeSearcher/releases/latest"
    }

- ç”±äº `Github` å›½å†…è®¿é—®é€Ÿåº¦ä¸å¦™ï¼Œæ‰€ä»¥æ›´æ–°é“¾æ¥ä½¿ç”¨ `Gitee` çš„é•œåƒåœ°å€

GET /system/clear
"""""""""""""""""""""""""""""""""
æ¸…ç©º API è§£æè¿‡ç¨‹ä¸­çš„ç¼“å­˜

è¿”å›å€¼:

.. code-block:: json

    {
        "clear": "success",
        "free": 2244.546875
    }

- `free` å­—æ®µä¸ºé‡Šæ”¾çš„ç¼“å­˜å¤§å°ï¼Œå•ä½ `KB`

GET /system/modules
"""""""""""""""""""""""""""""""""""
è·å–å¼•æ“æ¨¡å—ä¿¡æ¯

è¿”å›å€¼(ç»“æœè¿‡å¤šå·²çœç•¥):

.. code-block:: json

    {
        "anime": [
            {
                "enable": true,
                "module": "api.anime.agefans",
                "name": "AGEåŠ¨æ¼«",
                "notes": "å°‘éƒ¨åˆ†èµ„æºå­˜åœ¨æ°´å°ï¼Œå“åº”é€Ÿåº¦ä¹Ÿä¸é”™",
                "quality": 8,
                "type": [
                    "åŠ¨æ¼«"
                ]
            }
        ],
        "danmaku": [
            {
                "enable": true,
                "module": "api.danmaku.bilibili",
                "name": "å“”å“©å“”å“©",
                "notes": "æä¾›Bç«™å®˜æ–¹å’Œç”¨æˆ·ä¸Šä¼ ç•ªå‰§çš„å¼¹å¹•",
                "quality": 10
            }
        ],
        "comic": [],
        "music": []
    }

POST /system/modules
"""""""""""""""""""""""""""""""""""
å¯ç”¨/åœç”¨æŒ‡å®šçš„å¼•æ“æ¨¡å—

å‘é€ JSON, æ‰¹é‡ä¿®æ”¹å¼•æ“çŠ¶æ€:

.. code-block:: json

    [
        {
            "module": "api.anime.agefans",
            "enable": false
        },
        {
            "module": "api.anime.meijuxia",
            "enable": false
        },
        {
            "module": "api.danmaku.tencent",
            "enable": true
        },
        {
            "module": "api.foo.bar",
            "enable": true
        }
    ]

è¿”å›å€¼:

.. code-block:: json

    {
        "api.anime.agefans": "success",
        "api.anime.meijuxia": "success",
        "api.danmaku.tencent": "success",
        "api.foo.bar": "failed"
    }

- æ“ä½œæˆåŠŸè¿”å› `success`, å¤±è´¥è¿”å› `failed`
- æ‰¹é‡æ“ä½œæ”¯æŒå„ç§å¼•æ“çš„è‡ªç”±æ­é…
